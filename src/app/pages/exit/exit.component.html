<div class="appraisal-container employee-tab-container employee-exit tab-container project-list-container">
  <div class="row no-x-m mt-sm exit-wrapper">
    <div class="col-12">
      <h3>Exit</h3>

      <div class="projects-wrap employee-container employee-trainings-container projects-container">
        <tabset #exitTabs [vertical]="false" class="tab-container tab-horizontal">

          <tab>

            <ng-template tabHeading>
              <div class="tab-header">
                <div class="tab-header-content">
                  <div class="header no-m">Exit Information</div>
                </div>
              </div>
            </ng-template>

            <div class="tab-body">


              <div
                *ngIf="(myReporteesResignationDetails.length > 0 && userInfo.code !== employeeResignationDetail.employeeCode)"
                class="mt-sm">
                <div>
                  <h4 class="heading">My Reportees</h4>
                </div>
                <table class="table table-striped table-bordered" datatable [dtOptions]="dtOptionsWithHorizontalScroll">
                  <thead>
                    <tr>
                      <th rowspan="2" width="8%">Employee</th>
                      <!-- <th rowspan="2">Ec No</th> -->
                      <th colspan="2" class="text-center">Resigned</th>
                      <!-- <th rowspan="2" width="8%">Resigned Date</th> -->

                      <th colspan="3" class="text-center">Relieving Date</th>
                      <!-- <th rowspan="2">Relieving Date as per Policy</th>
                      <th rowspan="2">Confirmed Relieving Date</th> -->

                      <th rowspan="2" width="6%">Notice Period Shortfall</th>
                      <th colspan="4" class="text-center">Comments</th>
                      <th rowspan="2" width="6%">Status</th>
                      <th rowspan="2"></th>
                    </tr>
                    <tr class="table-less-size">

                      <th>Reason</th>
                      <th>Date</th>

                      <th>Requested</th>
                      <th width="7%">As per policy</th>
                      <th>Confirmed</th>

                      <th>RM Approval</th>
                      <th>HOD Approval</th>
                      <th>HR Approval</th>
                      <th>Rejected</th>
                    </tr>
                  </thead>
                  <tbody>
                    <tr *ngFor="let myReporteeResignation of myReporteesResignationDetails ">
                      <td>
                        <div>{{ myReporteeResignation.employeeName }}
                        </div>
                        <div>
                          {{ myReporteeResignation.employeeCode }}
                        </div>
                      </td>
                      <!-- <td>
                        <div>{{ myReporteeResignation.employeeCode }}</div>
                      </td> -->
                      <td>
                        <div class="data-ellipsis">
                          {{ myReporteeResignation.employeeResignationReason }}
                        </div>
                        <div *ngIf="canShowMoreDescription(myReporteeResignation.employeeResignationReason)">
                          <button class="data-ellipsis-more"
                            (click)="showMoreDescription(myReporteeResignation, myReporteeResignation.employeeResignationReason)">...more...</button>
                        </div>
                      </td>
                      <td>
                        <div>{{ myReporteeResignation.resignationDate | date: 'dd-MMM-yy' }}</div>
                      </td>
                      <td>
                        <div>{{ myReporteeResignation.preferredRelievingDate | date: 'dd-MMM-yy' }}</div>
                      </td>
                      <td>
                        <div>{{ myReporteeResignation.relievingDateAsPerPolicy | date: 'dd-MMM-yy' }}</div>
                      </td>
                      <td>
                        <div>{{ myReporteeResignation.relievingDate | date: 'dd-MMM-yy' }}</div>
                      </td>
                      <td>
                        <div>{{myReporteeResignation.shortfallDays}}</div>
                      </td>
                      <td>
                        <div class="data-ellipsis">{{ myReporteeResignation.l1ApprovalFeedbackForOthers }}</div>
                        <div *ngIf="canShowMoreDescription(myReporteeResignation.l1ApprovalFeedbackForOthers)">
                          <button class="data-ellipsis-more"
                            (click)="showMoreDescription(myReporteeResignation, myReporteeResignation.l1ApprovalFeedbackForOthers)">...more...</button>
                        </div>
                      </td>
                      <td>
                        <div class="data-ellipsis">{{ myReporteeResignation.l2ApprovalFeedbackForOthers }}</div>
                        <div *ngIf="canShowMoreDescription(myReporteeResignation.l2ApprovalFeedbackForOthers)">
                          <button class="data-ellipsis-more"
                            (click)="showMoreDescription(myReporteeResignation, myReporteeResignation.l2ApprovalFeedbackForOthers)">...more...</button>
                        </div>
                      </td>
                      <td>
                        <div class="data-ellipsis">{{ myReporteeResignation.hrApprovalFeedbackForOthers }}</div>
                        <div *ngIf="canShowMoreDescription(myReporteeResignation.hrApprovalFeedbackForOthers)">
                          <button class="data-ellipsis-more"
                            (click)="showMoreDescription(myReporteeResignation, myReporteeResignation.hrApprovalFeedbackForOthers)">...more...</button>
                        </div>
                      </td>
                      <td>
                        <div class="data-ellipsis">{{ myReporteeResignation.feedbackForOthers }}</div>
                        <div *ngIf="canShowMoreDescription(myReporteeResignation.feedbackForOthers)">
                          <button class="data-ellipsis-more"
                            (click)="showMoreDescription(myReporteeResignation, myReporteeResignation.feedbackForOthers)">...more...</button>
                        </div>
                      </td>
                      <td>
                        <div>{{ myReporteeResignation.isRevoked ? 'Revoked' : myReporteeResignation.status }}</div>
                      </td>
                      <td>
                        <div *ngIf="myReporteeResignation.status !== 'Completed' && !myReporteeResignation.isRevoked">
                          <div class="btn-group btn-dropdown ks-dropdown" dropdown
                            *ngIf="((myReporteeResignation.status === 'Pending' && userInfo.name === myReporteeResignation.manangerName) 
                      || (myReporteeResignation.status === 'L1-Approved' && userInfo.name === myReporteeResignation.seniorManangerName) 
                      || (myReporteeResignation.status === 'L2-Approved' && userInfo.role === 'HR')
                      || (myReporteeResignation.status === 'L1-Approved' && myReporteeResignation.seniorManangerName === null && userInfo.role === 'HR'))">
                            <button type="button" dropdownToggle
                              class="btn btn-primary dropdown-toggle btn-sm btn-dropdown hide-caret"
                              data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                              <i class="fa fa-ellipsis-v"></i>
                            </button>
                            <div *dropdownMenu class="dropdown-menu dropdown-menu-right">
                              <div>
                                <h6 class="dropdown-header">Actions</h6>

                                <li>
                                  <a class="dropdown-item default"
                                    (click)="hrReleivingDateModal(hrApprovalForm, myReporteeResignation)">
                                    <span class="mr-sm"><i class="fas fa-check"></i></span>
                                    <span>Approve</span>
                                  </a>
                                </li>
                                <li>
                                  <a class="dropdown-item default"
                                    (click)="rejectResignationModal(rejectForm, myReporteeResignation)">
                                    <span class="mr-sm"><i class="fas fa-times"></i></span>
                                    <span>Reject</span>
                                  </a>
                                </li>
                              </div>
                            </div>
                          </div>
                          <div class="btn-group btn-dropdown ks-dropdown" dropdown
                            *ngIf="(userInfo.role === 'HR' && (myReporteeResignation.status === 'HR-Approved' || myReporteeResignation.status === 'Exit-Processing'))">
                            <button type="button" dropdownToggle
                              class="btn btn-primary dropdown-toggle btn-sm btn-dropdown hide-caret"
                              data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                              <i class="fa fa-ellipsis-v"></i>
                            </button>
                            <div *dropdownMenu class="dropdown-menu dropdown-menu-right">
                              <div>
                                <h6 class="dropdown-header">Actions</h6>
                                <li *ngIf="(myReporteeResignation.status === 'HR-Approved')">
                                  <a class="dropdown-item default"
                                    (click)=" revokeResignationAlert(myReporteeResignation)">
                                    <span class="mr-sm"><i class="fas fa-undo"></i></span>
                                    <span>Revoke</span>
                                  </a>
                                </li>
                                <li *ngIf="(myReporteeResignation.status === 'HR-Approved')">
                                  <a class="dropdown-item default"
                                    (click)=" showInitiateClearanceModal(myReporteeResignation)">
                                    <span class="mr-sm"><i class="fas fa-file-alt"></i></span>
                                    <span>Initiate Clearance</span>
                                  </a>
                                </li>
                                <li>
                                  <a class="dropdown-item default"
                                    (click)=" showResignationModal(myReporteeResignation)">
                                    <span class="mr-sm"><i class="fas fa-file-alt"></i></span>
                                    <span>Resignation form</span>
                                  </a>
                                </li>
                                <li
                                  *ngIf="myReporteeResignation.status === 'Exit-Processing' && myReporteeResignation.isEmployeeExitFormSubmitted">
                                  <a class="dropdown-item default" (click)="showExitFormModal(myReporteeResignation)">
                                    <span class="mr-sm"><i class="fas fa-file-alt"></i></span>
                                    <span>Employee Feedback Form</span>
                                  </a>
                                </li>
                                <li
                                  *ngIf="myReporteeResignation.status === 'Exit-Processing' && myReporteeResignation.isHODFeedBackFormSubmitted">
                                  <a class="dropdown-item default"
                                    (click)="showHodFeedbackModal(myReporteeResignation)">
                                    <span class="mr-sm"><i class="fas fa-file-alt"></i></span>
                                    <span>HOD Feedback Form</span>
                                  </a>
                                </li>
                                <li *ngIf="myReporteeResignation.status === 'Exit-Processing'">
                                  <a class="dropdown-item default"
                                    (click)=" showHrFeedbackModal(myReporteeResignation)">
                                    <span class="mr-sm"><i class="fas fa-file-alt"></i></span>
                                    <span>HR Feedback Form</span>
                                  </a>
                                </li>
                                <li
                                  *ngIf="(myReporteeResignation.isEmployeeExitFormSubmitted && myReporteeResignation.isHODFeedBackFormSubmitted 
                              && myReporteeResignation.isHRFeedBackFormSubmitted && (!myReporteeResignation.employeeHasCompanyAsset || myReporteeResignation.isAssetHandOverCompleted))">
                                  <a class="dropdown-item default"
                                    (click)=" showCompleteClearanceModal(myReporteeResignation)">
                                    <span class="mr-sm"><i class="fas fa-check"></i></span>
                                    <span>Final HR Clearance</span>
                                  </a>
                                </li>
                                <li *ngIf="myReporteeResignation.status === 'Exit-Processing'">
                                  <a class="dropdown-item default"
                                    (click)="showAssetSubmitFormModal(myReporteeResignation.exitId, myReporteeResignation)">
                                    <span class="mr-sm"><i class="fas fa-file-alt"></i></span>
                                    <span>Asset (RM, HOD)</span>
                                  </a>
                                </li>
                              </div>
                            </div>
                          </div>
                          <div class="btn-group btn-dropdown ks-dropdown" dropdown
                            *ngIf="(myReporteeResignation.status === 'Exit-Processing' && userInfo.name === myReporteeResignation.manangerName)">
                            <button type="button" dropdownToggle
                              class="btn btn-primary dropdown-toggle btn-sm btn-dropdown hide-caret"
                              data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                              <i class="fa fa-ellipsis-v"></i>
                            </button>
                            <div *dropdownMenu class="dropdown-menu dropdown-menu-right">
                              <div>
                                <h6 class="dropdown-header">Actions</h6>
                                <li>
                                  <a class="dropdown-item default"
                                    (click)="showHodFeedbackModal(myReporteeResignation)">
                                    <span class="mr-sm"><i class="fas fa-file-alt"></i></span>
                                    <span>HOD Feedback Form</span>
                                  </a>
                                </li>
                              </div>
                            </div>
                          </div>
                        </div>
                      </td>
                    </tr>
                  </tbody>
                </table>
              </div>

              <div class="b-t mt-lg asset-clearance" *ngIf="exitAssetsEmployees.length > 0">
                <div>
                  <h4 class=" mt-md">Exit Clearance</h4>
                </div>
                <table datatable [dtOptions]="dtOptions" class="table table-responsive table-striped mt-md">
                  <thead>
                    <tr>
                      <th style="width: 25%;">Employee</th>
                      <th style="width: 25%;">Department</th>
                      <th style="width: 25%;">Relieving Date</th>
                      <th style="width: 10%;"></th>
                    </tr>
                  </thead>
                  <tbody>
                    <tr *ngFor="let exitAssetsEmployee of exitAssetsEmployees ">
                      <td>
                        <div>{{ exitAssetsEmployee.employeeName }}</div>
                        <div class="text-xxs text-primary">
                          <span>{{ exitAssetsEmployee.employeeCode }}</span>
                        </div>
                      </td>
                      <td>
                        <div>{{ exitAssetsEmployee.department }}</div>
                      </td>
                      <td>
                        <div>{{ exitAssetsEmployee.relievingDate | date: 'dd-MMM-yy' }}</div>
                      </td>
                      <td>
                        <div class="btn-group btn-dropdown ks-dropdown" dropdown>
                          <button type="button" dropdownToggle
                            class="btn btn-primary dropdown-toggle btn-sm btn-dropdown hide-caret"
                            data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                            <i class="fa fa-ellipsis-v"></i>
                          </button>
                          <div *dropdownMenu class="dropdown-menu dropdown-menu-right">
                            <div>
                              <h6 class="dropdown-header">Actions</h6>
                              <li>
                                <a class="dropdown-item default"
                                  (click)="showAssetSubmitFormModal(exitAssetsEmployee.empoyeeExitId, exitAssetsEmployee)">
                                  <span class="mr-sm"><i class="fas fa-laptop"></i></span>
                                  <span>Asset</span>
                                </a>
                              </li>
                            </div>
                          </div>
                        </div>
                      </td>
                    </tr>
                  </tbody>
                </table>
              </div>

              <div class="mt-sm" *ngIf="employeeResignationDetail.exitId">
                <table class="table table-striped">
                  <thead>
                    <tr>
                      <th
                        *ngIf="(employeeResignationDetail.status.includes('Rejected') || employeeResignationDetail.isRevoked)">
                        Resignation Reason</th>
                      <th
                        *ngIf="(employeeResignationDetail.status.includes('Rejected') || employeeResignationDetail.isRevoked)">
                        Date of Resignation</th>
                      <th>RM Approval Comments</th>
                      <th>HOD Approval Comments</th>
                      <th>HR Approval Comments</th>
                      <th *ngIf="employeeResignationDetail.shortfallDays">Notice Period Shortfall</th>
                      <th *ngIf="employeeResignationDetail.feedback">Rejected Comments</th>
                      <th style="width: 11%;">Status</th>
                      <th style="width: 5%"></th>
                    </tr>
                  </thead>
                  <tbody>
                    <tr>
                      <td
                        *ngIf="(employeeResignationDetail.status.includes('Rejected') || employeeResignationDetail.isRevoked)">
                        <div>{{ employeeResignationDetail.employeeResignationReason }}</div>
                      </td>
                      <td
                        *ngIf="(employeeResignationDetail.status.includes('Rejected') || employeeResignationDetail.isRevoked)">
                        <div>{{ employeeResignationDetail.resignationDate | date: 'dd-MMM-yy' }}</div>
                      </td>
                      <td>
                        <div>{{ employeeResignationDetail.l1ApprovalFeedback }}</div>
                      </td>
                      <td>
                        <div>{{ employeeResignationDetail.l2ApprovalFeedback }}</div>
                      </td>
                      <td>
                        <div>{{ employeeResignationDetail.hrApprovalFeedback }}</div>
                      </td>
                      <td *ngIf="employeeResignationDetail.shortfallDays">
                        <div>{{ employeeResignationDetail.shortfallDays }}</div>
                      </td>
                      <td *ngIf="employeeResignationDetail.feedback">
                        <div>{{ employeeResignationDetail.feedback }}</div>
                      </td>
                      <td>
                        <div>{{ employeeResignationDetail.isRevoked ? 'Revoked' : employeeResignationDetail.status }}
                        </div>
                      </td>
                      <td class="text-center">
                        <div class="btn-group btn-dropdown ks-dropdown" dropdown
                          *ngIf="employeeResignationDetail.status === 'Exit-Processing'">
                          <button type="button" dropdownToggle
                            class="btn btn-primary dropdown-toggle btn-sm btn-dropdown hide-caret"
                            data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                            <i class="fa fa-ellipsis-v"></i>
                          </button>
                          <div *dropdownMenu class="dropdown-menu dropdown-menu-right">
                            <div>
                              <h6 class="dropdown-header">Actions</h6>
                              <li>
                                <a class="dropdown-item default" (click)="showExitFormModal(employeeResignationDetail)">
                                  <span class="mr-sm"><i class="fas fa-file-alt"></i></span>
                                  <span>Exit Form</span>
                                </a>
                              </li>
                            </div>
                          </div>
                        </div>
                      </td>
                    </tr>
                  </tbody>
                </table>
              </div>

            </div>

          </tab>

          <tab>

            <ng-template tabHeading>
              <div class="tab-header">
                <div class="tab-header-content">
                  <div class="header no-m">Rehire Process</div>
                </div>
              </div>
            </ng-template>

            <div class="tab-body">
              <h4 class=" mt-md">Resigned Employee Information</h4>


              <table class="table table-responsive table-striped mt-md">
                <thead>
                  <tr>
                    <th>Name</th>
                    <th>Employee code</th>
                    <th>Department </th>
                    <th>Designation</th>
                    <th>Grade</th>
                    <th>Date of Joining</th>
                    <th>Last Working Date</th>
                    <th>Desired / Undesired</th>
                    <th></th>
                  </tr>
                </thead>
                <tbody>
                  <tr *ngFor="let employee of employeeRehireDetailsReport">
                    <td>{{employee.name}}</td>
                    <td>{{employee.code}}</td>
                    <td>{{employee.department}}</td>
                    <td>{{employee.designation}}</td>
                    <td>{{employee.grade}}</td>
                    <td>{{employee.formattedDateOfJoining}}</td>
                    <td>{{employee.formattedDateOfReliieving}}</td>
                    <td>{{employee.desired}}</td>
                    <td>
                      <div class="btn-group btn-dropdown ks-dropdown" dropdown>
                        <button type="button" dropdownToggle
                          class="btn btn-primary dropdown-toggle btn-sm btn-dropdown hide-caret" data-toggle="dropdown"
                          aria-haspopup="true" aria-expanded="false">
                          <i class="fa fa-ellipsis-v"></i>
                        </button>
                        <div *dropdownMenu class="dropdown-menu dropdown-menu-right">
                          <div>
                            <h6 class="dropdown-header">Actions</h6>
                            <li>
                              <a class="dropdown-item default" (click)="viewEmployeeDetails(employee)">
                                <span class="mr-sm"><i class="fas fa-laptop"></i></span>
                                <span>View Employee</span>
                              </a>
                            </li>
                            <li *ngIf="employee.rehired !== 'Yes'">
                              <a class="dropdown-item default" (click)="addNewEmployeeModal(employee)">
                                <span class="mr-sm"><i class="fas fa-laptop"></i></span>
                                <span>Rehire</span>
                              </a>
                            </li>
                          </div>
                        </div>
                      </div>
                    </td>
                  </tr>
                </tbody>
              </table>

            </div>



          </tab>
        </tabset>




      </div>
    </div>




  </div>

  <!-- Approve Resignation -->
  <app-custom-modal #hrApproveModal [title]="'Resignation Detail'" [modalSize]="'lg'"
    [subTitle]="'Capture employee resignation detail'">

    <form #hrApprovalForm="ngForm">
      <div class="row">
        <div [ngClass]=" 'col-6'" *ngIf="userInfo.role === 'HR'">
          <div class="form-group">
            <label class="form-title required">Confirmed Relieving Date</label>
            <label class="form-explanation">Enter the employee relieving date.</label>
            <input #relievingDateVar="ngModel" [(ngModel)]="updateEmployeeExit.relievingDate" name="relievingDate"
              type="text" placeholder="Select a date" class="form-control" bsDatepicker [bsConfig]="datePickerOptions"
              [minDate]="minDate" required autocomplete="off">
            <app-custom-validation [model]="relievingDateVar" [required]="'Choose the relieving date of employee.'">
            </app-custom-validation>
          </div>
        </div>
        <div [ngClass]=" 'col-12'">
          <div class="form-group">
            <label class="form-title required">Approve Comments For Employee</label>
            <label class="form-explanation">Enter the approval comments for employee.</label>
            <textarea #approvalFeedbackVar="ngModel" class="form-control" name="approvalFeedback" type="text" rows="5"
              required [(ngModel)]="updateEmployeeExit.feedback"></textarea>
            <app-custom-validation [model]="approvalFeedbackVar" [required]="'Enter the comments.'">
            </app-custom-validation>
          </div>
        </div>
        <div [ngClass]=" 'col-12'">
          <div class="form-group">
            <label class="form-title required">Approve Comments For Others</label>
            <label class="form-explanation">Enter the approval comments for RM/HOD/HR.</label>
            <textarea #approvalFeedbackForOthersVar="ngModel" class="form-control" name="approvalFeedbackForOthers"
              type="text" rows="5" required [(ngModel)]="updateEmployeeExit.feedbackForOthers"></textarea>
            <app-custom-validation [model]="approvalFeedbackForOthersVar" [required]="'Enter the comments.'">
            </app-custom-validation>
          </div>
        </div>
        <div class="col-lg-12 mt-lg">
          <button class="btn btn-primary" [disabled]="isProcessing || !hrApprovalForm.valid"
            (click)="approveResignationAlert(null)" [ngClass]="isProcessing ? 'spinning' : ''">
            <span>Approve</span>
            <i class="fas fa-spinner spinner"></i>
          </button>
        </div>
      </div>
    </form>
  </app-custom-modal>

  <!-- Reject Resignation -->
  <app-custom-modal #rejectReasonModal [title]="'Reject Resignation'" [modalSize]="'lg'"
    [subTitle]="'Reason for rejecting resignation'">

    <form #rejectForm="ngForm">
      <div class="row">
        <div [ngClass]=" 'col-12'">
          <div class="form-group">
            <label class="form-title required">Reject Reason For Employee</label>
            <label class="form-explanation">Enter the reason to reject resignation.</label>
            <textarea #rejectReasonVar="ngModel" class="form-control" name="rejectReason" type="text" required
              [(ngModel)]="updateEmployeeExit.feedback" rows="5"></textarea>
            <app-custom-validation [model]="rejectReasonVar" [required]="'Enter the resignation reason.'">
            </app-custom-validation>
          </div>
        </div>
        <div [ngClass]=" 'col-12'">
          <div class="form-group">
            <label class="form-title required">Reject Reason For Others</label>
            <label class="form-explanation">Enter the reason to reject resignation for RM/HOD/HR.</label>
            <textarea #rejectReasonForOthersVar="ngModel" class="form-control" name="rejectReasonForOthers" type="text"
              required [(ngModel)]="updateEmployeeExit.feedbackForOthers" rows="5"></textarea>
            <app-custom-validation [model]="rejectReasonForOthersVar" [required]="'Enter the resignation reason.'">
            </app-custom-validation>
          </div>
        </div>
        <div class="col-lg-12 mt-lg">
          <button class="btn btn-primary" [disabled]="isProcessing || !rejectForm.valid"
            (click)="rejectResignationAlert(rejectForm)" [ngClass]="isProcessing ? 'spinning' : ''">
            <span>Reject</span>
            <i class="fas fa-spinner spinner"></i>
          </button>
        </div>
      </div>
    </form>
  </app-custom-modal>

  <!-- HR Initiate Clearance Modal -->
  <app-custom-modal #hrClearanceModal [title]="'Initiate Clearance'" [modalSize]="'lg'"
    [subTitle]="'Initiate Employee Clearance'">
    <form #hrClearanceForm="ngForm">
      <div class="row">
        <div [ngClass]=" 'col-8'">
          <div class="form-group">
            <label class="form-title">Revised Relieving Date</label>
            <label class="form-explanation">Enter the revised relieving date of employee.</label>
            <input type="text" #relievingDateVar="ngModel" [(ngModel)]="updateEmployeeExit.relievingDate"
              name="relievingDate" bsDatepicker [bsConfig]="datePickerOptions" [minDate]="minDate"
              placeholder="Select a date" class="form-control" autocomplete="off">
          </div>
        </div>
        <div class="col-lg-12 mt-lg">
          <button class="btn btn-primary" [disabled]="isProcessing || !hrClearanceForm.valid"
            (click)="initiateEmployeeClearanceAlert()" [ngClass]="isProcessing ? 'spinning' : ''">
            <span>Submit</span>
            <i class="fas fa-spinner spinner"></i>
          </button>
        </div>
      </div>
    </form>
  </app-custom-modal>

  <!-- HR Complete Clearance Modal -->
  <app-custom-modal #hrCompleteClearanceModal [title]="'Final HR Clearance'" [modalSize]="'lg'"
    [subTitle]="'Complete Final HR Clearance'">
    <form #hrCompleteClearanceForm="ngForm">
      <div class="row">
        <div class="col-lg-12">
          <div class="form-group">
            <label class="form-title required">Comments</label>
            <label class="form-explanation">Enter the comments</label>
            <textarea #commentsVar="ngModel" class="form-control" name="commentsVar" rows="5" type="text" required
              [(ngModel)]="updateEmployeeExit.clearanceComments"></textarea>
            <app-custom-validation [model]="commentsVar" [required]="'Enter comments'">
            </app-custom-validation>
          </div>
        </div>
        <div class="col-lg-4">
          <div class="form-group">
            <label class="form-title required">Eligible for Rehire</label>
            <label class="form-explanation">Is employee eligible for rehire?</label>
            <div class="row no-x-m">
              <div class="col-6">
                <input name="radio-rehire" class="custom-radio primary" id="eligibile-rehire" type="radio" required
                  [value]="true" [(ngModel)]="updateEmployeeExit.eligibleForRehire">
                <label for="eligibile-rehire">
                  <span class="text">Yes</span>
                </label>
              </div>

              <div class="col-6">
                <input name="radio-rehire" class="custom-radio primary" id="uneligible-rehire" type="radio" required
                  [value]="false" [(ngModel)]="updateEmployeeExit.eligibleForRehire">
                <label for="uneligible-rehire">
                  <span class="text">No</span>
                </label>
              </div>
            </div>
          </div>
        </div>
        <div class="col-lg-12 mt-lg">
          <button class="btn btn-primary" [disabled]="isProcessing || !hrCompleteClearanceForm.valid"
            (click)="completeEmployeeClearanceAlert()" [ngClass]="isProcessing ? 'spinning' : ''">
            <span>Submit</span>
            <i class="fas fa-spinner spinner"></i>
          </button>
        </div>
      </div>
    </form>
  </app-custom-modal>

  <!-- Employee Exit Form -->
  <app-custom-modal *ngIf="employeeExitId > 0 && displayExitModal" #empExitFormModal
    [title]="'Employee Exit Feedback Form'" [modalSize]="'xl'" [subTitle]="'Employee exit feedback form'">
    <app-employee-feedback [employeeExit]="empResignationDetail" [feedbackModal]="empExitFormModal">
    </app-employee-feedback>
  </app-custom-modal>


  <!-- HOD Feedback Form -->
  <app-custom-modal *ngIf="employeeExitId > 0 && displayHODModal" #hodFeedbackModal [title]="'HOD Feedback Form'"
    [modalSize]="'xl'" [subTitle]="'HOD feedback form'">
    <app-hod-feedback [employeeExit]="myReporteeResignationDetail" [feedbackModal]="hodFeedbackModal">
    </app-hod-feedback>
  </app-custom-modal>


  <!-- HR Feedback Form -->
  <app-custom-modal *ngIf="employeeExitId > 0 && displayHRModal" #hrFeedbackModal [title]="'HR Feedback Form'"
    [modalSize]="'xl'" [subTitle]="'HR feedback form'">
    <app-hr-feedback [employeeExit]="myReporteeResignationDetail" [feedbackModal]="hrFeedbackModal"
      [getMyReporteesResignationDetails]="getMyReporteesResignationDetails"></app-hr-feedback>
  </app-custom-modal>

  <!-- Resignation Form -->
  <app-custom-modal #resignationModal [title]="'Resignation'" [modalSize]="'xl'" [subTitle]="''">
    <app-employee-resign [empResignationDetail]="empResignationDetail" [feedbackModal]="resignationModal">
    </app-employee-resign>
  </app-custom-modal>

  <!-- more description-->

  <app-custom-modal #moreDescriptionModal [title]="currentEmployeeName" [subTitle]="currentEmployeeCode"
    [modalSize]="'xl'" [subTitle]="''">
    <div>
      {{currentDescirpition}}
    </div>
  </app-custom-modal>

  <!-- <app-custom-modal #createEmployeeModal [title]="'Add New Employee'" [hideCloseButton]="true"
    [subTitle]="'Enter the details of the employee to be added. Once added you can update more details in the employee details page.'">
    <app-create-employee [createEmployeeModal]="createEmployeeModal"></app-create-employee>
  </app-custom-modal> -->

  <app-custom-modal #rehireEmployeeModal [title]="'Rehire Employee'" [hideCloseButton]="true"
    [subTitle]="'Enter the details of the employee to be added. Once added you can update more details in the employee details page.'">
    <!-- <app-employee-rehire [rehireEmployeeModal]="rehireEmployeeModal" [selectedRehireEmployee]="selectedRehireEmployee"></app-employee-rehire> -->
    <div class="new-employee">
      <form #employeeForm="ngForm" class="form show-character-count">
  
          <div *ngIf="isEmailAlreadyAdded" class="alert alert-danger alert-sm">
              <span>An employee with the same email id is already added in the system. Duplicate email ids cannot be
                  added.</span>
          </div>
  
          <div class="form-group">
              <label class="form-title required">Employee Name</label>
              <label class="form-explanation">Enter the name of the employee.</label>
              <input #employeeNameVar="ngModel" class="form-control" name="employeeName" [(ngModel)]="rehireEmployee.name"
                  type="text" required />
              <app-custom-validation [model]="employeeNameVar" [required]="'Enter the name for the employee.'">
              </app-custom-validation>
          </div>
  
          <div class="form-group">
              <label class="form-title required">Employee Email</label>
              <label class="form-explanation">Enter the official login email for the employee.</label>
              <input #employeeEmailVar="ngModel" class="form-control" name="employeeEmail"
                  [(ngModel)]="rehireEmployee.officialEmail" type="email" ngvemail required />
              <app-custom-validation [model]="employeeEmailVar" [required]="'Enter the official email for the employee.'"
                  [email]="'Enter the email properly.'">
              </app-custom-validation>
          </div>
  
          <div class="form-group">
              <label class="form-title required">Employee Old Email</label>
              <label class="form-explanation">Enter the old email for the employee.</label>
              <input #employeeOldEmailVar="ngModel" class="form-control" name="employeeOldEmail"
                  [(ngModel)]="rehireEmployee.oldEmail" type="email" ngvemail required />
              <app-custom-validation [model]="employeeOldEmailVar" [required]="'Enter the old email for the employee.'"
                  [email]="'Enter the old email properly.'">
              </app-custom-validation>
          </div>
  
          <div class="form-group">
              <label class="form-title required">Employee Code</label>
              <label class="form-explanation">Enter the code for the employee.</label>
              <input #employeeCodeVar="ngModel" class="form-control" name="employeeCode"
                  [(ngModel)]="rehireEmployee.employeeCode" type="email" required />
              <app-custom-validation [model]="employeeCodeVar" [required]="'Enter the code for the employee.'">
              </app-custom-validation>
          </div>
          <div class="form-group">
              <label class="form-title required">Status</label>
              <label class="form-explanation">Choose the employee status.</label>
  
              <div class="col-4">
                  <input name="status-radio" class="custom-radio primary" id="status-radio-off" type="radio"
                      [value]="'off-roll'" [(ngModel)]="rehireEmployee.status">
                  <label for="status-radio-off">
                      <span class="text">Off Roll</span>
                  </label>
              </div>
  
              <div class="col-4">
                  <input name="status-radio" class="custom-radio primary" id="status-radio-on" type="radio"
                      [value]="'on-roll'" [(ngModel)]="rehireEmployee.status">
                  <label for="status-radio-on">
                      <span class="text">On Roll</span>
                  </label>
              </div>
  
              <div class="col-4">
                  <input name="status-radio" class="custom-radio primary" id="status-radio-trainee" type="radio"
                      [value]="'trainee'" [(ngModel)]="rehireEmployee.status">
                  <label for="status-radio-trainee">
                      <span class="text">Trainee</span>
                  </label>
              </div>
  
              <div class="col-6">
                  <input name="status-radio" class="custom-radio primary" id="status-radio-temp" type="radio"
                      [value]="'temp'" [(ngModel)]="rehireEmployee.status">
                  <label for="status-radio-temp">
                      <span class="text">Casual / Temp</span>
                  </label>
              </div>
  
              <!-- <app-custom-validation [model]="roleVar" [required]="'Choose a role for the employee.'">
          </app-custom-validation> -->
          </div>
  
          <div class="form-group">
              <label class="form-title required">Can Login</label>
              <label class="form-explanation">Check the box is the user will be allowed to login into the
                  application.</label>
  
              <div class="col-12">
                  <input #canLoginVar="ngModel" name="canLogin-checkbox" class="custom-checkbox primary"
                      id="canLogin-checkbox" type="checkbox" [value]="true" [(ngModel)]="rehireEmployee.canLogin">
                  <label for="canLogin-checkbox">
                      <span class="text">Can Login</span>
                  </label>
              </div>
  
          </div>
  
          <div class="form-group">
              <label class="form-title">Role</label>
              <label class="form-explanation">Choose the role to be assigned to the employee.</label>
              <ng-select #roleVar="ngModel" name="roleOptions" [(ngModel)]="rehireEmployee.roleSelection"
                  (change)="rehireEmployee.roleId = $event.value" [items]="employeeRoles" [multiple]="false"
                  [clearable]="false" required placeholder="Choose employee role">
              </ng-select>
              <app-custom-validation [model]="roleVar" [required]="'Choose a role for the employee.'">
              </app-custom-validation>
          </div>
  
      </form>
  
  </div>
  <div class="rehire-employee-footer">
      <button type="submit" class="btn btn-primary" [disabled]="isProcessing"
          [ngClass]="[isProcessing ? 'spinning' : '', !employeeForm.valid ? 'disabled' : '']"
          (click)="rehireOldEmployee(employeeForm)">
          <span>Rehire Employee</span>
          <i class="fas fa-spinner spinner"></i>
      </button>
      <button type="button" class="btn btn-dark btn-outline" (click)="hideRehireModal()">Close</button>
  </div>
  </app-custom-modal>


  <!-- Asset Submission Form -->
  <app-custom-modal #assetSubmitFormModal [title]="'Exit Clearance'" [modalSize]="'xl'"
    [subTitle]="'Employee Exit Clearance Form'">
    <div class="text-center">
      {{empResignationDetail.employeeCode}} - {{empResignationDetail.employeeName}}
    </div>
    <div class="print-button-wrap col-lg-12">
      <button class="dt-button buttons-print btn btn-primary btn-md" (click)="printPage()" tabindex="0" type="button">
        <span><i class="fa fa-print"></i> Print</span>
      </button>
    </div>
    <div class="printed-date">
      Printed on : {{printedDate}}
    </div>
    <table class="table table-responsive table-striped table-asset-submission">
      <thead>
        <tr>
          <th style="width: 30%;">Asset Type</th>
          <th style="width: 20%;">Asset Unique ID</th>
          <th style="width: 10%;">Claim Amount If Damaged</th>
          <th style="width: 20%;">Comments</th>
          <th style="width: 20%;">HOD Comments</th>
          <th style="width: 15%;">Status</th>
          <th style="width: 5%;"></th>
        </tr>
      </thead>
      <tbody>
        <ng-container *ngFor="let employeeExitAssetDetail of employeeExitAssetDetails ">
          <tr
            *ngIf="(employeeExitAssetDetail.employeeCode === userInfo.code ||  userInfo.role === 'HR' || employeeExitAssetDetail.loggedInUserAssetOwner || (employeeExitAssetDetail.isDefaultRMHODAssets && (employeeId === employeeExitAssetDetail.seniorManager || employeeId === employeeExitAssetDetail.manager)))">
            <td>
              <div>{{ employeeExitAssetDetail.assetType }}</div>
            </td>
            <td>
              <div>{{ employeeExitAssetDetail.assetUniqueId }}</div>
            </td>
            <td>
              <div>
                <input #claimAmtVar="ngModel" class="form-control" name="claimAmtVar"
                  [disabled]="employeeExitAssetDetail.status  !== 'Pending'" placeholder="Claim amount"
                  [(ngModel)]="employeeExitAssetDetail.assetBreakageFee" type="number" min="0"
                  oninput="validity.valid||(value='');" />
              </div>
            </td>
            <td>
              <div>
                <input #commentsVar="ngModel" class="form-control" name="commentsVar"
                  [disabled]="employeeExitAssetDetail.status  !== 'Pending'"
                  [(ngModel)]="employeeExitAssetDetail.comments" />
              </div>
            </td>
            <td>
              <div>
                <input #hodCommentsVar="ngModel" class="form-control" name="hodCommentsVar"
                  [disabled]="(employeeExitAssetDetail.status === 'Completed' || (employeeExitAssetDetail.status  === 'L1-Approved' && employeeId === employeeExitAssetDetail.manager) || employeeExitAssetDetail.status  === 'Pending')"
                  [(ngModel)]="employeeExitAssetDetail.hodComments" />
              </div>
            </td>
            <td>
              <div>{{ employeeExitAssetDetail.status }}</div>
            </td>
            <td>
              <div
                *ngIf="((employeeExitAssetDetail.status === 'Pending' && employeeExitAssetDetail.isDefaultRMHODAssets && employeeId === employeeExitAssetDetail.manager)
              || (employeeExitAssetDetail.loggedInUserAssetOwner && employeeExitAssetDetail.status === 'Pending' && !employeeExitAssetDetail.isDefaultRMHODAssets)
              || (employeeId === employeeExitAssetDetail.manager && employeeExitAssetDetail.status === 'Owner-Approved')
              || (employeeId === employeeExitAssetDetail.seniorManager && employeeExitAssetDetail.status === 'L1-Approved'))"
                class="btn-group btn-dropdown ks-dropdown" dropdown>
                <button type="button" dropdownToggle
                  class="btn btn-primary dropdown-toggle btn-sm btn-dropdown hide-caret" data-toggle="dropdown"
                  aria-haspopup="true" aria-expanded="false">
                  <i class="fa fa-ellipsis-v"></i>
                </button>
                <div *dropdownMenu class="dropdown-menu dropdown-menu-right">
                  <div>
                    <h6 class="dropdown-header">Actions</h6>
                    <li>
                      <a class="dropdown-item default" (click)="updateExitEmployeeAssetStatus(employeeExitAssetDetail)">
                        <span class="mr-sm"><i class="fas fa-check"></i></span>
                        <span>Approve</span>
                      </a>
                    </li>
                  </div>
                </div>
              </div>
            </td>
          </tr>
        </ng-container>
      </tbody>
    </table>
  </app-custom-modal>